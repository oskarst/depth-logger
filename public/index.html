<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lake Logger</title>
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#f7fafc">
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('/service-worker.js'));
    }
  </script>
</head>
<body>
  <div class="app-shell light">
    <header class="topbar">
      <div id="last-saved" class="last-saved" aria-live="polite">Last saved: ‚Äî</div>
      <div id="live-line" class="live-line">Live: waiting for GPS‚Ä¶</div>
    </header>

    <main class="content">
      <!-- PROJECT SELECTION SCREEN -->
      <section id="screen-projects" class="screen active">
        <div class="projects-wrap">
          <div class="projects-header">
            <div class="map-title">Select Project</div>
          </div>
          <div id="projects-list" class="projects-list"></div>
          <div class="projects-actions">
            <input type="text" id="new-project-input" class="project-input" placeholder="New project name..." />
            <button id="add-project-btn" class="btn small">Add</button>
          </div>
        </div>
      </section>

      <div id="logger-content" class="logger-content hidden">
        <div class="status-row">
          <span id="coord-status" class="badge">GPS: Unknown</span>
          <span id="offline-badge" class="badge secondary">Offline ready</span>
          <button id="loc-btn" class="btn small" title="Enable GPS">Enable GPS</button>
          <button id="sync-btn" class="btn small" title="Sync unsent entries">Sync</button>
          <button id="export-btn" class="btn small ghost" title="Export data as JSON">Export</button>
          <button id="import-btn" class="btn small ghost" title="Import JSON data">Import</button>
          <input type="file" id="import-file-input" accept=".json" style="display:none" />
        </div>

      <!-- LOGGER SCREEN -->
      <section id="screen-logger" class="screen">
        <div id="pad" class="pad"></div>
      </section>

      <!-- DATA SCREEN -->
      <section id="screen-data" class="screen">
        <div class="data-wrap">
          <div class="map-header data-header">
            <div class="map-title">Data Points</div>
            <div class="data-actions">
              <button id="clear-btn" class="btn small danger" title="Clear all data">Clear</button>
            </div>
          </div>
          <div class="table-wrap">
            <table id="data-table">
              <thead>
                <tr>
                  <th>Time</th>
                  <th>Depth (m)</th>
                  <th>Fish</th>
                  <th>Lat</th>
                  <th>Lon</th>
                  <th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- MAP SCREEN -->
      <section id="screen-map" class="screen">
        <div class="map-wrap">
          <div class="map-header">
            <div class="map-title">Depth Map</div>
            <div class="map-layers" id="map-layers">
              <label class="layer-toggle"><input type="checkbox" id="layer-depth" checked><span>Depth</span></label>
              <label class="layer-toggle"><input type="checkbox" id="layer-contours" checked><span>Contours</span></label>
              <label class="layer-toggle"><input type="checkbox" id="layer-points" checked><span>Points</span></label>
              <label class="layer-toggle"><input type="checkbox" id="layer-weeds" checked><span>Weeds</span></label>
            </div>
          </div>
          <div class="map-legend" id="map-legend"></div>
          <div id="depth-map"></div>
        </div>
      </section>

      <!-- LIVE MAP SCREEN -->
      <section id="screen-livemap" class="screen">
        <div class="livemap-container">
          <div id="live-map" class="live-map"></div>
          <div id="live-pad" class="pad pad-compact"></div>
        </div>
      </section>
      </div><!-- /logger-content -->
    </main>

    <footer class="bottombar">
      <div class="bottombar-left">
        <span id="bottombar-project" class="bottombar-project">No project</span>
        <button id="change-project-btn" class="btn small ghost" title="Change project">Change</button>
      </div>
      <div class="bottombar-right">
        <button id="fish-btn" class="fish-btn" title="Tag last point as Has Fish" aria-label="Has Fish">üêü</button>
        <button id="livemap-btn" class="map-btn" title="Live Map">üìç</button>
        <button id="map-btn" class="map-btn" title="Open depth map">üó∫Ô∏è</button>
        <button id="data-btn" class="map-btn" title="Open data">üìã</button>
      </div>
    </footer>
  </div>

  <template id="entry-pill-tpl">
    <div class="pill"></div>
  </template>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
  <script src="/app.js" type="module"></script>
</body>
</html>
